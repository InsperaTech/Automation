# Define the source file path
$sourceFile = "\\SourceServer\Share\File.txt"

# Define an array of destination servers
$destinationServers = @("DestinationServer1", "DestinationServer2", "DestinationServer3")

# Define the credentials for remote authentication
$username = "YourUsername"
$password = ConvertTo-SecureString "YourPassword" -AsPlainText -Force
$credentials = New-Object System.Management.Automation.PSCredential($username, $password)

# Loop through each destination server
foreach ($destinationServer in $destinationServers) {
    try {
        # Establish a PowerShell remoting session to the destination server using provided credentials
        $session = New-PSSession -ComputerName $destinationServer -Credential $credentials

        # Copy the file to the destination server
        Copy-Item -Path $sourceFile -Destination "C:\DestinationPath\" -ToSession $session -Force

        # Install the software on the destination server
        Invoke-Command -Session $session -ScriptBlock {
            $sourceFilePath = "C:\DestinationPath\File.txt"
            # Add your installation command here
            # Example: Start-Process -FilePath "msiexec.exe" -ArgumentList "/i `"$sourceFilePath`" /quiet" -Wait
            Write-Output "Software installed on $($env:COMPUTERNAME)"
        }

        Write-Output "File copied and software installed successfully on $destinationServer"
    } catch {
        Write-Error "Failed to copy file or install software on $destinationServer. $_"
    } finally {
        # Close the PowerShell remoting session
        Remove-PSSession $session
    }
}
